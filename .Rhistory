data_albert$WEEK=(seq(1:nrow(data_week)))
data_c= data%>% filter(Chain=="C-1000")%>%select(1:10)
data_c$WEEK=(seq(1:nrow(data_week)))
data_jumbo= data%>% filter(Chain=="JUMBO")%>%select(1:10)
data_jumbo$WEEK=(seq(1:nrow(data_week)))
data_edah= data%>% filter(Chain=="EDAH")%>%select(1:10)
data_edah$WEEK=(seq(1:nrow(data_week)))
data_super= data%>% filter(Chain=="SUPER DE BOER")%>%select(1:10)
data_super$WEEK=(seq(1:nrow(data_week)))
data_total= rbind(data_albert,data_c,data_jumbo,data_edah,data_super)
data_total%>%filter(Chain=='ALBERT HEIJN')%>%ggplot( aes(x=WEEK, y=REXONASales)) +
geom_line()
data_total%>%filter(Chain=='C-1000')%>%ggplot( aes(x=WEEK, y=REXONASales)) +
geom_line()
data_total%>%filter(Chain=='JUMBO')%>%ggplot( aes(x=WEEK, y=REXONASales)) +
geom_line()
data_total%>%filter(Chain=='EDAH')%>%ggplot( aes(x=WEEK, y=REXONASales)) +
geom_line()
data_total%>%filter(Chain=='SUPER DE BOER')%>%ggplot( aes(x=WEEK, y=REXONASales)) +
geom_line()
data_numeric= data_total%>% select(c(-1,-2))
View(data_numeric)
data_total %>% data_numeric/rowSums(data_numeric)*100
data_total_percet= round(prop.table(as.matrix(data_total[,c(-1,-2)],1)),2)
View(data_total_percet)
rm(data_total_percet)
data_total_percent= round(data_total/rowSums(data_total),2)
data_total_percent= round(data_total_n/rowSums(data_total_n),2)
data_total_n= data_total%>% select(c(-1,-2))
data_total_percent= round(data_total_n/rowSums(data_total_n),2)
View(data_total_percet)
View(data_total_percent)
data_total_nn=data_total%>%select(c(-1,-2))
data_total_percent = datacbind(data_total_nn,data_total_percent)
data_total_percent = cbind(data_total_nn,data_total_percent)
View(data_total_percent)
data_total_nn=data_total%>%select(c(1,2))
data_total= rbind(data_albert,data_c,data_jumbo,data_edah,data_super)
data_total%>%filter(Chain=='ALBERT HEIJN')%>%ggplot( aes(x=WEEK, y=REXONASales)) +
geom_line()
data_total%>%filter(Chain=='C-1000')%>%ggplot( aes(x=WEEK, y=REXONASales)) +
geom_line()
data_total%>%filter(Chain=='JUMBO')%>%ggplot( aes(x=WEEK, y=REXONASales)) +
geom_line()
data_total%>%filter(Chain=='EDAH')%>%ggplot( aes(x=WEEK, y=REXONASales)) +
geom_line()
data_total%>%filter(Chain=='SUPER DE BOER')%>%ggplot( aes(x=WEEK, y=REXONASales)) +
geom_line()
####### Evolution of market share in each retailer
data_total$sum= rowSums(data_total[c(-1,-2)])
data_total_n= data_total%>% select(c(-1,-2))
data_total_nn=data_total%>%select(c(1,2))
data_total_percent= round(data_total_n/rowSums(data_total_n),2)
data_share = cbind(data_total_nn,data_total_percent)
View(data_total_percent)
data_super= data%>% filter(Chain=="SUPER DE BOER")%>%select(1:10)
data_super$WEEK=(seq(1:nrow(data_week)))
data_total= rbind(data_albert,data_c,data_jumbo,data_edah,data_super)
data_total%>%filter(Chain=='ALBERT HEIJN')%>%ggplot( aes(x=WEEK, y=REXONASales)) +
geom_line()
data_total%>%filter(Chain=='C-1000')%>%ggplot( aes(x=WEEK, y=REXONASales)) +
geom_line()
data_total%>%filter(Chain=='JUMBO')%>%ggplot( aes(x=WEEK, y=REXONASales)) +
geom_line()
data_total%>%filter(Chain=='EDAH')%>%ggplot( aes(x=WEEK, y=REXONASales)) +
geom_line()
data_total%>%filter(Chain=='SUPER DE BOER')%>%ggplot( aes(x=WEEK, y=REXONASales)) +
geom_line()
####### Evolution of market share in each retailer
data_total_n= data_total%>% select(c(-1,-2))
data_total_nn=data_total%>%select(c(1,2))
data_total_percent= round(data_total_n/rowSums(data_total_n),2)
data_share = cbind(data_total_nn,data_total_percent)
View(data_total_percent)
View(data_share)
data_share%>%filter(Chain=='ALBERT HEIJN')%>%ggplot( aes(x=WEEK, y=REXONASales)) +
geom_line()
data_share%>%filter(Chain=='C-1000')%>%ggplot( aes(x=WEEK, y=REXONASales)) +
geom_line()
data_share%>%filter(Chain=='JUMBO')%>%ggplot( aes(x=WEEK, y=REXONASales)) +
geom_line()
data_share%>%filter(Chain=='SUPER DE BOER')%>%ggplot( aes(x=WEEK, y=REXONASales)) +
geom_line()
data_share%>%ggplot( aes(x=WEEK, y=REXONASales)) +
geom_line()
odd_numbers= data_share%>% filter(REXONASales>0.4)
View(odd_numbers)
odd_numbers= data_share%>% filter(REXONASales>0.4 |REXONASales<0.1 )
View(odd_numbers)
#How does this market share differ between retailers?
data_share%>% group_by(Chain)%>% mean(REXONASales)
#How does this market share differ between retailers?
data_share%>% group_by(Chain)%>% select(3:10)%>%mean(REXONASales)
#How does this market share differ between retailers?
data_share%>% group_by(Chain)%>% select(3:10)%>%summarise(meen= mean(REXONASales))
#How does this market share differ between retailers?
data_share%>% group_by(Chain)%>% select(3:10)%>%summarise(mean(REXONASales))
View(data_share)
data = read_excel("Data.xls")
#How does the brand’s price level and promotional support levels compare to the
#levels observed with competing brands? Are the insights retailer specific?
View(data)
#How does the brand’s price level and promotional support levels compare to the
#levels observed with competing brands? Are the insights retailer specific?
colnames(data)
rownames(data)
#How does the brand’s price level and promotional support levels compare to the
#levels observed with competing brands? Are the insights retailer specific?
colnames(data)
cbind(df[1,2],df[19]-df[11],df[20]-df[12],df[21]-df[13],df[22]-df[14],df[23]-df[15],df[24]-df[16], df[25]-df[17],df[26]-df[18])
cbind(df[1,2],df[19:26]-df[11:18])
cbind(data[1,2],data[19:26]-data[11:18])
data_price= round(cbind(data[1,2],data[19:26]-data[11:18]),2)
data_price= cbind(data[1,2],data[19:26]-data[11:18])
data_price
View(data_price)
View(data)
data = read_excel("Data.xls")
data_price= cbind(data[1,2],data[19:26]-data[11:18])
View(data_price)
View(data)
View(data[,1])
typeof(data_pri)
typeof(data_price)
data_price=as.data.frame(data_price)
data = read_excel("Data.xls")
data_price= cbind(data[1,2],data[19:26]-data[11:18])
data_price=as.data.frame(data_price)
View(data_price)
data_price= cbind(data[1:2],data[19:26]-data[11:18])
View(data_price)
data_price= cbind(data[1:2],data[19:26]-data[11:18])
View(data_price)
data_price%>% group_by(Chain)%>% select(3:10)%>%summarise(mean(REXONASales))
data_price%>% group_by(Chain)%>% select(3:10)%>%summarise(mean(REXONARprice))
data_price%>% group_by(Chain)%>% select(3:10)%>%summarise(mean(REXONARPrice))
colnames(data_price)
data_price%>% group_by(Chain)%>% select(3:10)%>%summarise(mean(DOVERPrice))
data_price%>% group_by(Chain)%>% select(3:10)%>%summarise(mean(FARRPrice))
data_price%>% group_by(Chain)%>% select(3:10)%>%summarise(mean(FARPrice))
data_price%>% group_by(Chain)%>% select(3:10)%>%summarise(mean(NIVEARPrice))
data_price%>% group_by(Chain)%>% select(3:10)%>%summarise(mean(SANEXRPrice))
data_price%>% group_by(Chain)%>% select(3:10)%>%summarise(mean(VOGUERPrice))
data_price%>% group_by(Chain)%>% select(3:10)%>%summarise(mean(8x4Price))
data_price%>% group_by(Chain)%>% select(3:10)%>%summarise(mean(8X4Price))
data_price%>% group_by(Chain)%>% select(3:10)%>%summarise(mean('8X4Price'))
#How does the brand’s price level and promotional support levels compare to the
#levels observed with competing brands? Are the insights retailer specific?
colnames(data)
data_price%>% group_by(Chain)%>% select(3:10)%>%summarise(mean(8X4RPrice))
data = gsub('8X4','a8X4',data)
data = read_excel("Data.xls")
View(data)
data = read_excel("Data.xls")
#How does the brand’s price level and promotional support levels compare to the
#levels observed with competing brands? Are the insights retailer specific?
colnames(data_price)
data_price%>% group_by(Chain)%>% select(3:10)%>%summarise(mean(\\8X4RPrice))
colnames(data_price[9])='_8X4RPrice'
colnames(data_price[9])='a8X4RPrice'
data_price%>% group_by(Chain)%>% select(3:10)%>%summarise(mean(a8X4RPrice))
data_price%>% group_by(Chain)%>% select(3:10)%>%summarise(mean('a8X4RPrice'))
data_price%>% group_by(Chain)%>% select(3:10)%>%summarise(mean(a8X4RPrice))
colnames(data_price[9])='a8X4RPrice'
colnames(data_price)
colnames(data_price)[9]='a8X4RPrice'
data_price%>% group_by(Chain)%>% select(3:10)%>%summarise(mean(a8X4RPrice))
data_price%>% group_by(Chain)%>% select(3:10)%>%summarise(mean(VOGUERPrice))
data_price%>% group_by(Chain)%>% select(3:10)%>%summarise(mean(VOGUERPrice))
data_price%>% group_by(Chain)%>% select(3:10)%>%summarise(mean(SANEXRPrice))
data_price%>% group_by(Chain)%>% select(3:10)%>%summarise(mean(REXONARPrice))
###############Promotion
colnames(data)
dim(data)
data_promo= cbind(data[1:2],data[27:50])
###############Promotion
colnames(data_promo)
colnames(data_price)[8]='a8X4DISP'
colnames(data_price)[16]='a8X4FEAT'
colnames(data_promo)[8]='a8X4DISP'
colnames(data_promo)[16]='a8X4FEAT'
colnames(data_promo)[8]='a8X4D+F'
#############PRice
data_price= cbind(data[1:2],data[19:26]-data[11:18])
###############Promotion
colnames(data_promo)
colnames(data_promo)[8]='a8X4DISP'
colnames(data_promo)[16]='a8X4FEAT'
colnames(data_promo)[24]='a8X4D+F'
###############Promotion
colnames(data_promo)
View(data_promo)
data_promo%>% group_by(Chain)%>% select(3:10)%>%summarise(mean(REXONADISP))
data_promo%>% group_by(Chain)%>% select(3:10)%>%summarise(mean(DOVEDIS))
data_promo%>% group_by(Chain)%>% select(3:10)%>%summarise(mean(DOVEDISP))
data_promo%>% group_by(Chain)%>% select(3:10)%>%summarise(mean(FADISP))
data_promo%>% group_by(Chain)%>% select(3:10)%>%summarise(mean(NIVEADISP))
data_promo%>% group_by(Chain)%>% select(3:10)%>%summarise(mean(SANEXDISP))
data_promo%>% group_by(Chain)%>% select(3:10)%>%summarise(mean(VOGUEDISP))
data_promo%>% group_by(Chain)%>% select(3:10)%>%summarise(mean(a8X4DISP))
data_promo%>% select(3:10)%>%summarise(mean(REXONADISP))
data_promo%>% group_by(Chain)%>% select(3:10)%>%summarise(mean(REXONADISP))
data_promo%>% select(3:10)%>%summarise(mean(a8X4DISP))
data_promo%>% select(3:10)%>%summarise(mean(VOGUEDISP))
data_promo%>% select(3:10)%>%summarise(mean(SANEXDISP))
data_promo%>% select(3:10)%>%summarise(mean(NIVEADISP))
data_promo%>% select(3:10)%>%summarise(mean(FADISP))
data_promo%>% select(3:10)%>%summarise(mean(DOVEDISP))
data_promo%>% select(3:10)%>%summarise(mean(REXONADISP))
data_price%>% summarise(mean(REXONARPrice))
data_price%>%summarise(mean(DOVERPrice))
data_price%>% select(3:10)%>%summarise(mean(FARPrice))
data_price%>% select(3:10)%>%summarise(mean(NIVEARPrice))
data_price%>% select(3:10)%>%summarise(mean(SANEXRPrice))
data_price%>% group_by(Chain)%>% select(3:10)%>%summarise(mean(SANEXRPrice))
data_price%>% select(3:10)%>%summarise(mean(SANEXRPrice))
data_price%>% select(3:10)%>%summarise(mean(a8X4RPrice))
colnames(data_price)[9]='a8X4RPrice'
data_promo%>% select(3:10)%>%summarise(mean(a8X4DISP))
data_promo%>% select(3:10)%>%summarise(mean(VOGUEDISP))
data_price%>% select(3:10)%>%summarise(mean(a8X4RPrice))
#####FEATURE
colnames(data)
data_feature= cbind(data[1:2],data[35:42])
#####FEATURE
colnames(data_feature)
#####FEATURE
rm(data_feature)
###############Promotion
#####DISPLAY
colnames(data_promo)
data_promo%>% group_by(Chain)%>% select(11:19)%>%summarise(mean(REXONAFEAT))
data_promo%>% select(11:19)%>%summarise(mean(REXONAFEAT))
data_promo%>% group_by(Chain)%>% select(11:19)%>%summarise(mean(DOVEFEAT))
data_promo%>% select(11:19)%>%summarise(mean(DOVEFEAT))
data_promo%>% group_by(Chain)%>% select(11:19)%>%summarise(mean(FAFEAT))
data_promo%>% select(11:19)%>%summarise(mean(FAFEAT))
data_promo%>% group_by(Chain)%>% select(11:19)%>%summarise(mean(NIVEAFEAT))
data_promo%>% select(11:19)%>%summarise(mean(NIVEAFEAT))
data_promo%>% group_by(Chain)%>% select(11:19)%>%summarise(mean(SANEXFEAT))
data_promo%>% select(11:19)%>%summarise(mean(SANEXFEAT))
data_promo%>% group_by(Chain)%>% select(11:19)%>%summarise(mean(VOGUEFEAT))
data_promo%>% select(11:19)%>%summarise(mean(VOGUEFEAT))
data_promo%>% group_by(Chain)%>% select(11:19)%>%summarise(mean(a8X4FEAT))
data_promo%>% select(11:19)%>%summarise(mean(a8X4FEAT))
COLNAMES(data)
colnames(data)
data_price
data%>% filter(Chain=='ALBERT HEIJN')%>% diff(data$REXONAPrice)
data$REXONAPrice
data%>% filter(Chain=='ALBERT HEIJN')
#Can you visually detect evidence of a price war among the brands and/or
#supermarkets? If yes, explain how you got to that conclusion.
colnames('data')
#Can you visually detect evidence of a price war among the brands and/or
#supermarkets? If yes, explain how you got to that conclusion.
colnames(data)
data%>% filter(Chain=='ALBERT HEIJN')%>% select(11:18)
data%>% filter(Chain=='ALBERT HEIJN')%>% select(11:18)%>% diff(data$NIVEASales)
data%>% filter(Chain=='ALBERT HEIJN')%>% select(11:18)%>% diff(,1,1)
data%>% filter(Chain=='ALBERT HEIJN')%>% select(11:18)%>% diff(1,1)
data%>% filter(Chain=='ALBERT HEIJN')%>% select(11:18)%>% diff(,lag= 1,differences =1)
data%>% filter(Chain=='ALBERT HEIJN')%>% select(11:18)%>% diff(lag= 1,differences =1)
data%>% filter(Chain=='ALBERT HEIJN')%>% select(11:18)%>% diff(data$NIVEASales lag= 1,differences =1)
data%>% filter(Chain=='ALBERT HEIJN')%>% select(11:18)%>% diff(data$NIVEASales, lag= 1,differences =1)
diff(data$DOVESales,1,1)
data = read_excel("Data.xls")
data_albert= data%>% filter(Chain=="ALBERT HEIJN")%>%select(1:10)
data_albert$WEEK=(seq(1:nrow(data_week)))
data_c= data%>% filter(Chain=="C-1000")%>%select(1:10)
data_c$WEEK=(seq(1:nrow(data_week)))
data_jumbo= data%>% filter(Chain=="JUMBO")%>%select(1:10)
data_jumbo$WEEK=(seq(1:nrow(data_week)))
data_edah= data%>% filter(Chain=="EDAH")%>%select(1:10)
data_edah$WEEK=(seq(1:nrow(data_week)))
data_super= data%>% filter(Chain=="SUPER DE BOER")%>%select(1:10)
data_super$WEEK=(seq(1:nrow(data_week)))
data_total= rbind(data_albert,data_c,data_jumbo,data_edah,data_super) # this is market sales
data_total%>%filter(Chain=='ALBERT HEIJN')%>%ggplot( aes(x=WEEK, y=REXONASales)) +
geom_line()
data_albert= data%>% filter(Chain=="ALBERT HEIJN")
diff(data$REXONAPrice,1,1)
data_albert= data%>% filter(Chain=="ALBERT HEIJN")
data_c= data%>% filter(Chain=="C-1000")
data_jumbo= data%>% filter(Chain=="JUMBO")
data_edah= data%>% filter(Chain=="EDAH")
data_super= data%>% filter(Chain=="SUPER DE BOER")
diff(data_albert$SANEXPrice,1,1)
diff(data_albert$REXONAPrice,1,1)
diff(data_albert$DOVEPrice,1,1)
diff(data_albert$FAPrice,1,1)
diff(data_albert$NIVEAPrice,1,1)
diff(data_albert$SANEXPrice,1,1)
diff(data_albert$VOGUEPrice,1,1)
diff(data_albert$`8X4Price`,1,1)
diff(data_albert$REXONAPrice,1,1)
diff(data_albert$DOVEPrice,1,1)
diff(data_albert$FAPrice,1,1)
diff(data_albert$NIVEAPrice,1,1)
diff(data_albert$SANEXPrice,1,1)
diff(data_albert$VOGUEPrice,1,1)
diff(data_albert$`8X4Price`,1,1)
diff(data_albert$`8X4Price`,1,1)
df = cbind(Rexona,Dove)
df = data.frame(Rexona,Dove)
df = data.frame('Rexona','Dove')
df
typeof(Rexona)
Rexona = diff(data_albert$REXONAPrice,1,1)
typeof(Rexona)
df = data.frame(Rexona, Dove)
Dove = diff(data_albert$DOVEPrice,1,1)
Fa= diff(data_albert$FAPrice,1,1)
Nivea = diff(data_albert$NIVEAPrice,1,1)
Sanex = diff(data_albert$SANEXPrice,1,1)
Vogue = diff(data_albert$VOGUEPrice,1,1)
`8X4Price` = diff(data_albert$`8X4Price`,1,1)
df = data.frame(Rexona, Dove)
df = data.frame(Rexona, Dove,Fa, Nivea, Sanex, Vogue,`8X4Price )
df = data.frame(Rexona, Dove,Fa, Nivea, Sanex, Vogue,`8X4Price` )
`8X4Price` = diff(data_albert$`8X4Price`,1,1)
df = data.frame(Rexona, Dove,Fa, Nivea, Sanex, Vogue,`8X4Price` )
df
df = data.frame(Rexona, Dove,Fa, Nivea, Sanex, Vogue,`8X4Price` )
df
View(df)
matplot(df, type = c("b"),pch=1,col = 1:4)
matplot(df, type = c("b"),pch=1,col = 1:7)
matplot(df, type = c("b"),pch=1,col = 1)
library(Hmist)
install.packages(Hmist)
library(Hmisc)
install.packages(Hmisc)
install.packages('Hmisc')
library(Hmisc)
mycor<- rcorr(as.matrix(df))
mycor
data.frame(
row = rownames(cormat)[row(cormat)[ut]],
column = rownames(cormat)[col(cormat)[ut]],
cor  =(cormat)[ut],
p = pmat[ut]
)
flattenCorrMatrix(mycor$r, mycor$P)
data.frame(
row = rownames(cormat)[row(cormat)[ut]],
column = rownames(cormat)[col(cormat)[ut]],
cor  =(cormat)[ut],
p = pmat[ut]
)
cormat<- rcorr(as.matrix(df))
flattenCorrMatrix <- function(cormat, pmat) {
ut <- upper.tri(cormat)
data.frame(
row = rownames(cormat)[row(cormat)[ut]],
column = rownames(cormat)[col(cormat)[ut]],
cor  =(cormat)[ut],
p = pmat[ut]
)
}
flattenCorrMatrix(cormat$r, cormat$P)
data_cor= rbind(data_albert,data_c, data_jumbo,data_edah,data_super,data_cor)
data_cor= rbind(data_albert,data_c, data_jumbo,data_edah,data_super,data_cor)
data_cor= rbind(data_albert,data_c, data_jumbo,data_edah,data_super)
View(data_cor)
data_albert= data%>% filter(Chain=="ALBERT HEIJN")%>%select(1:10)
data_albert$WEEK=(seq(1:nrow(data_albert)))
View(data_albert)
data_c= data%>% filter(Chain=="C-1000")%>%select(1:10)
data_c$WEEK=(seq(1:nrow(data_c)))
data_jumbo= data%>% filter(Chain=="JUMBO")%>%select(1:10)
data_jumbo$WEEK=(seq(1:nrow(data_jumbo)))
data_edah= data%>% filter(Chain=="EDAH")%>%select(1:10)
data_edah$WEEK=(seq(1:nrow(data_edah)))
data_super= data%>% filter(Chain=="SUPER DE BOER")%>%select(1:10)
data_super$WEEK=(seq(1:nrow(data_super)))
data_albert= data%>% filter(Chain=="ALBERT HEIJN")
data_albert$WEEK=(seq(1:nrow(data_albert)))
data_albert= data%>% filter(Chain=="ALBERT HEIJN")
data_c= data%>% filter(Chain=="C-1000")
data_jumbo= data%>% filter(Chain=="JUMBO")
data_edah= data%>% filter(Chain=="EDAH")
data_super= data%>% filter(Chain=="SUPER DE BOER")
data_albert$WEEK=(seq(1:nrow(data_albert)))
data_c$WEEK=(seq(1:nrow(data_c)))
data_jumbo$WEEK=(seq(1:nrow(data_jumbo)))
data_edah$WEEK=(seq(1:nrow(data_edah)))
data_super$WEEK=(seq(1:nrow(data_super)))
data_cor= rbind(data_albert,data_c, data_jumbo,data_edah,data_super)
View(data_cor)
Rexona = diff(data_albert$REXONAPrice,1,1)
Dove = diff(data_albert$DOVEPrice,1,1)
Fa= diff(data_albert$FAPrice,1,1)
Nivea = diff(data_albert$NIVEAPrice,1,1)
Sanex = diff(data_albert$SANEXPrice,1,1)
Vogue = diff(data_albert$VOGUEPrice,1,1)
`8X4Price` = diff(data_albert$`8X4Price`,1,1)
df = data.frame(Rexona, Dove,Fa, Nivea, Sanex, Vogue,`8X4Price` )
cormat<- rcorr(as.matrix(df))
flattenCorrMatrix <- function(cormat, pmat) {
ut <- upper.tri(cormat)
data.frame(
row = rownames(cormat)[row(cormat)[ut]],
column = rownames(cormat)[col(cormat)[ut]],
cor  =(cormat)[ut],
p = pmat[ut]
)
}
flattenCorrMatrix(cormat$r, cormat$P)
Rexona = diff(data_cor$REXONAPrice,1,1)
Dove = diff(data_cor$DOVEPrice,1,1)
Fa= diff(data_cor$FAPrice,1,1)
Nivea = diff(data_cor$NIVEAPrice,1,1)
Sanex = diff(data_cor$SANEXPrice,1,1)
Vogue = diff(data_cor$VOGUEPrice,1,1)
`8X4Price` = diff(data_cor$`8X4Price`,1,1)
df = data.frame(Rexona, Dove,Fa, Nivea, Sanex, Vogue,`8X4Price` )
cormat<- rcorr(as.matrix(df))
flattenCorrMatrix <- function(cormat, pmat) {
ut <- upper.tri(cormat)
data.frame(
row = rownames(cormat)[row(cormat)[ut]],
column = rownames(cormat)[col(cormat)[ut]],
cor  =(cormat)[ut],
p = pmat[ut]
)
}
flattenCorrMatrix(cormat$r, cormat$P)
library(corrplot)
corrplot(res, type = "upper", order = "hclust",
tl.col = "black", tl.srt = 45)
corrplot(cormat, type = "upper", order = "hclust",
tl.col = "black", tl.srt = 45)
corrplot(df, type = "upper", order = "hclust",
tl.col = "black", tl.srt = 45)
res= cor(df)
res
corrplot(res, type = "upper", order = "hclust",
tl.col = "black", tl.srt = 45)
library(PerformanceAnalytics)
chart.Correlation(df, histogram=TRUE, pch=19)
corrplot(res, type = "upper", order = "hclust",
tl.col = "black", tl.srt = 45)
data = read_excel("Data.xls")
data_albert= data%>% filter(Chain=="ALBERT HEIJN")%>%select(1:10)
data_albert$WEEK=(seq(1:nrow(data_albert)))
View(data_albert)
data_c= data%>% filter(Chain=="C-1000")%>%select(1:10)
data_c$WEEK=(seq(1:nrow(data_c)))
data_jumbo= data%>% filter(Chain=="JUMBO")%>%select(1:10)
data_jumbo$WEEK=(seq(1:nrow(data_jumbo)))
data_edah= data%>% filter(Chain=="EDAH")%>%select(1:10)
data_edah$WEEK=(seq(1:nrow(data_edah)))
data_super= data%>% filter(Chain=="SUPER DE BOER")%>%select(1:10)
data_super$WEEK=(seq(1:nrow(data_super)))
data_total= rbind(data_albert,data_c,data_jumbo,data_edah,data_super)
View(data_share)  # This is market shares
### Seasonality
data_share%>% group_by(WEEK)%>% summarise(total = sum(REXONASales))
### Seasonality
seasonality = data_share%>% group_by(WEEK)%>% summarise(total = sum(REXONASales))
View(seasonality)
?colSums
colsums(seasonality,nrow=12)
colSums(seasonality,nrow=12)
colSums(as.matrix(seasonality),nrow=12)
seasonality=as.matrix(seasonality)
colSums(seasonality,nrow= 12)
colSums(seasonality,NROW= 12)
colSums(matrix(seasonality,nrow = 12))
colSums(matrix(seasonality,nrow = 11))
colSums(matrix(seasonality,nrow = 10))
colSums(matrix(seasonality,nrow = 4))
dim(data_share)
dim(seasonality)
colSums(matrix(seasonality,nrow = 12))
### Seasonality
seasonality = data_share%>% group_by(WEEK)%>% summarise(total = sum(REXONASales))
colSums(matrix(seasonality,nrow = 12))
seasonality=as.matrix(seasonality)
dim(seasonality)
rollsum(seasonality,12)
rollsum=rollsum(seasonality,12)
View(rollsum)
rollsum=rollsum(seasonality,12, right)
rollsum=rollsum(seasonality,12, align= right)
rollsum=rollsum(seasonality,12, align= 'right')
View(rollsum)
### Seasonality
seasonality = data_share%>% group_by(WEEK)%>% summarise(total = sum(REXONASales))
rollsum=rollsum(seasonality$total,12)
View(rollsum)
?rollsum
?rollsum
rm(rollsum)
?rollsum
colSums(matrix(seasonality$total,nrow = 12))
124/12
125/12
124/4
124/4.5
124/14
124/4
sum(seasonality[::12])
sum(seasonality[1:12])
sum(seasonality[,1:12])
apply.rolling(seasonality,FUN="sum",width = 12)
colSums(matrix(seasonality$total,nrow = 12))
final=colSums(matrix(seasonality$total,nrow = 12))
View(final)
final=colMeans(matrix(seasonality$total,nrow = 12))
View(final)
