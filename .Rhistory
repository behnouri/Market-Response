evolution$`mean(rexona_value)`=rexona_value
evolution$`mean(rexona_value)`='rexona_value'
ggplot(evolution, aes(x=WEEK)) +
geom_line(aes(y = rexona_value), color = "darkred")
ggplot(evolution, aes(x=WEEK)) +
geom_line(aes(y = 'rexona_value'), color = "darkred")
ggplot(evolution, aes(x=WEEK)) +
geom_line(aes(y = rexona_value), color = "darkred")
evolution$rexona_value=evolution$`mean(rexona_value)`
data_value_final$WEEK=as.numeric(data_value_final$WEEK)
evolution=data_value_final%>% group_by(WEEK)%>% summarise(mean(rexona_value))
evolution$rexona_value=evolution$`mean(rexona_value)`
data_value_final$WEEK=as.numeric(data_value_final$WEEK)
evolution=data_value_final%>% group_by(WEEK)%>% summarise(mean(rexona_value))
colnames(evolution)=c("WEEK","rexona_value")
ggplot(evolution, aes(x=WEEK)) +
geom_line(aes(y = rexona_value), color = "darkred")
data$WEEK=gsub("W","",data$WEEK)
data$WEEK=as.numeric(data$WEEK)
evolution_total=data%>% group_by(WEEK)%>% summarise(mean(rexona_value))
colnames(evolution1)=c("WEEK","rexona_value")
ggplot(evolution1, aes(x=WEEK)) +
geom_line(aes(y = rexona_value), color = "darkred")
data$WEEK=gsub("W","",data$WEEK)
data$WEEK=as.numeric(data$WEEK)
evolution_1=data%>% group_by(WEEK)%>% summarise(mean(rexona_value))
colnames(evolution1)=c("WEEK","rexona_value")
ggplot(evolution1, aes(x=WEEK)) +
geom_line(aes(y = rexona_value), color = "darkred")
data$WEEK=gsub("W","",data$WEEK)
data$WEEK=as.numeric(data$WEEK)
evolution_1=data%>% group_by(WEEK)%>% summarise(mean(rexona_value))
colnames(evolution_1)=c("WEEK","rexona_value")
ggplot(evolution_1, aes(x=WEEK)) +
geom_line(aes(y = rexona_value), color = "darkred")
data = read_excel("Data.xls")
data_value_final$WEEK= gsub("W","",data$WEEK)
data_value_final$WEEK=as.numeric(data_value_final$WEEK)
evolution=data_value_final%>% group_by(WEEK)%>% summarise(mean(rexona_value))
colnames(evolution)=c("WEEK","rexona_value")
ggplot(evolution, aes(x=WEEK)) +
geom_line(aes(y = rexona_value), color = "darkred")
colnames(evolution)=c("Week","Rexona Market Share")
ggplot(evolution, aes(x=WEEK)) +
geom_line(aes(y = rexona_value), color = "darkred")
ggplot(evolution, aes(x=Week)) +
geom_line(aes(y = Rexona Market Share), color = "darkred")
colnames(evolution)=c("Week","Rexona Market Share")
ggplot(evolution, aes(x=Week)) +
geom_line(aes(y = Rexona Market Share), color = "darkred")
colnames(evolution)=c("Week","Rexona_Market_Share")
ggplot(evolution, aes(x=Week)) +
geom_line(aes(y = Rexona_Market_Share), color = "darkred")
data_value_final$WEEK= gsub("W","",data$WEEK)
data_value_final$WEEK=as.numeric(data_value_final$WEEK)
evolution=data_value_final%>% group_by(WEEK)%>% summarise(median(rexona_value))
colnames(evolution)=c("Week","Rexona_Market_Share")
ggplot(evolution, aes(x=Week)) +
geom_line(aes(y = Rexona_Market_Share), color = "darkred")
data%>%dplyr::select(3:10)%>%summarise_all(funs(sum))
data%>%dplyr::select(3:10)%>%group_by(WEEK)%>%summarise_all(funs(sum))
data%>%dplyr::select(2:10)%>%group_by(WEEK)%>%summarise_all(funs(sum))
data%>%dplyr::select(2:10)%>%group_by(WEEK)%>%summarise(funs(sum))
data%>%dplyr::select(2:10)%>%group_by(WEEK)%>%summarise_all(rowsum())
data%>%dplyr::select(2:10)%>%group_by(WEEK)%>%summarise(funs(rowsum))
data%>%dplyr::select(2:10)%>%group_by(WEEK)%>%summarise(funs(rowSums()))
data%>%dplyr::select(2:10)%>%group_by(WEEK)%>%summarise(funs(rowSums)
data%>%dplyr::select(2:10)%>%group_by(WEEK)%>%summarise(funs(rowSums))
data%>%dplyr::select(2:10)%>%group_by(WEEK)%>%summarise(funs(rowSums))
data%>%dplyr::select(2:10)%>%group_by(WEEK)%>%summarise(rowSums(data[3:10]))
summarized= data%>%dplyr::select(2:10)%>%group_by(WEEK)%>%summarise
(rowSums(summarized[3:10]))
View(summarized)
summarized= data%>%dplyr::select(2:10)%>%group_by(WEEK)
summarized= data%>%dplyr::select(2:10)%>%group_by(WEEK)
summarized= data%>%dplyr::select(2:10)%>%group_by(WEEK)%>% summarise(rowSums(data(3:10)))
summarized= data%>%dplyr::select(2:10)%>%group_by(WEEK)%>% summarise(rowSums(data[3:10]))
data$sum= rowSums(data[3:10])
View(data)
data$sum
aggregate( WEEK~ sum, satData, mean)
aggregate( WEEK~ sum, data, mean)
data%>% select(sum)%>% group_by(WEEK)%>% summarize(sum)
data%>% select(sum)%>% group_by(WEEK)%>% summarize(mean)
data%>% select(51)%>% group_by(WEEK)%>% summarize(mean)
data%>% select(51:51)%>% group_by(WEEK)%>% summarize(mean)
data%>% dplyr::select(51:51)%>% group_by(WEEK)%>% summarize(mean)
data%>% dplyr::select(51:51)%>% group_by('WEEK')%>% summarize(mean)
data%>% dplyr::select(c(1,51))%>% group_by(WEEK)%>% summarize(mean)
data%>% dplyr::select(c(2,51))%>% group_by(WEEK)%>% summarize(mean)
data%>% dplyr::select(c(2,51))%>% group_by(WEEK)%>% summarize(mean(data$sum))
data%>%dplyr::select(c(2,51))%>%group_by(WEEK)%>% summarise(Score = sum(sum))
summarie = data%>%dplyr::select(c(2,51))%>%group_by(WEEK)%>% summarise(Score = sum(sum))
summariez = data%>%dplyr::select(c(2,51))%>%group_by(WEEK)%>% summarise(Score = sum(sum))
summarize = data%>%dplyr::select(c(2,51))%>%group_by(WEEK)%>% summarise(Score = sum(sum))
View(summarize)
ggplot(summarize, aes(x=Week)) +
geom_line(aes(y = Score), color = "darkred")
ggplot(summarize, aes(x=WEEK)) +
geom_line(aes(y = Score), color = "darkred")
colnames(summarize)=c("Week","Market_Size_Volume")
summarize$Week=gsub("W","",summarize$WEEK)
summarize$Week=gsub("W","",summarize$WeeK)
summarize = data%>%dplyr::select(c(2,51))%>%group_by(WEEK)%>% summarise(Score = sum(sum))
colnames(summarize)=c("Week","Market_Size_Volume")
summarize$Week=gsub("W","",summarize$WeeK)
summarize = data%>%dplyr::select(c(2,51))%>%group_by(WEEK)%>% summarise(Score = sum(sum))
summarize$WEEK=gsub("W","",summarize$WEEK)
summarize$WEEK=as.numeric(summarize$WEEK)
colnames(summarize)=c("Week","Market_Size_Volume")
ggplot(summarize, aes(x=WEEK)) +
geom_line(aes(y = Score), color = "darkred")
ggplot(summarize, aes(x=WEEK)) +
geom_line(aes(y = Market_Size_Volume), color = "darkred")
ggplot(summarize, aes(x=Week)) +
geom_line(aes(y = Market_Size_Volume), color = "darkred")
data_price= cbind(data[1:2],data[19:26]-data[11:18])
colnames(data_price)[9]='a8X4RPrice'
data_price%>% group_by(Chain)%>% select(3:10)%>%summarise(mean(REXONARPrice))
data_price= cbind(data[1:2],data[19:26]-data[11:18])
colnames(data_price)[9]='a8X4RPrice'
data_price%>% group_by(Chain)%>% dplyr::select(3:10)%>%summarise(mean(REXONARPrice))
colnames(data[19:26])
colnames(data[11:18])
data_price= cbind(data[1:2],data[19:26]-data[11:18])
colnames(data_price)[9]='a8X4RPrice'
data_price%>% group_by(Chain)%>% dplyr::select(3:10)%>%summarise(mean(REXONARPrice))
data_price%>% summarise(mean(REXONARPrice))
data%>%dplyr::select(3:10)%>%summarise_all(funs(sum))
pie_data=data%>% group_by(Chain)%>% summarise(total = sum(REXONASales))
pie_data_p=pie_data%>% mutate(total_p= round(total/sum(total),2))
pie_data_p
#How does this market share differ between retailers?
data_share%>% group_by(Chain)%>% dplyr::select(3:10)%>%summarise(mean(REXONASales))  #Volume
data_value= round(data[51:58]/rowSums(data[51:58]),2)
data_value_final= cbind(data[1:2],data_value)
data_value_final%>% group_by(Chain)%>%summarise(mean(rexona_value))
data_price%>% group_by(Chain)%>% dplyr::select(3:10)%>%summarise(mean(DOVERPrice))
data_price%>% summarise(mean(REXONARPrice))
data_price%>% group_by(Chain)%>% dplyr::select(3:10)%>%summarise(mean(REXONARPrice))
colnames(data[19:26])
colnames(data[11:18])
data_price%>% group_by(Chain)%>% dplyr::select(3:10)%>%summarise(mean(DOVERPrice))
data_price%>% group_by(Chain)%>% dplyr::select(3:10)%>%summarise(mean(FARPrice))
data_price%>% group_by(Chain)%>% dplyr::select(3:10)%>%summarise(mean(NIVEARPrice))
data_price%>% group_by(Chain)%>% dplyr::select(3:10)%>%summarise(mean(FARPrice))
data_price%>% group_by(Chain)%>% dplyr::select(3:10)%>%summarise(mean(NIVEARPrice))
data_price%>% group_by(Chain)%>%dplyr::select(3:10)%>%summarise(mean(SANEXRPrice))
data_price%>% group_by(Chain)%>% dplyr::select(3:10)%>%summarise(mean(VOGUERPrice))
data_price%>% group_by(Chain)%>% dplyr::select(3:10)%>%summarise(mean(a8X4RPrice))
data_price%>% select(3:10)%>%summarise(mean(a8X4RPrice))
data_price%>% select(3:10)%>%summarise(mean(a8X4RPrice))
data_price%>%summarise(mean(DOVERPrice))
data_price%>%select(3:10)%>%summarise(mean(DOVERPrice))
data_price%>%dplyr::select(3:10)%>%summarise(mean(DOVERPrice))
data_price%>% summarise(mean(REXONARPrice))
data_price%>%dplyr::select(3:10)%>%summarise(mean(DOVERPrice))
data_price%>% summarise(mean(FARPrice))
data_price%>% summarise(mean(NIVEARPrice))
data_price%>% select(3:10)%>%summarise(mean(VOGUERPrice))
data_price%>%summarise(mean(VOGUERPrice))
data_price%>%summarise(mean(a8X4RPrice))
data_price%>%summarise(mean(VOGUERPrice))
data_price%>% summarise(mean(SANEXRPrice))
data_price%>%summarise(mean(VOGUERPrice))
data_price%>% summarise(mean(SANEXRPrice))
colnames(data_promo)
data_promo= cbind(data[1:2],data[27:50])
colnames(data_promo)[8]='a8X4DISP'
colnames(data_promo)[16]='a8X4FEAT'
colnames(data_promo)[24]='a8X4D+F'
data_promo%>% group_by(Chain)%>% dplyr::select(3:10)%>%summarise(mean(REXONADISP))
data_promo%>% select(3:10)%>%summarise(mean(REXONADISP))
data_promo%>% summarise(mean(REXONADISP))
data_promo%>% group_by(Chain)%>%dplyr::select(3:10)%>%summarise(mean(DOVEDISP))
data_promo%>% select(3:10)%>%summarise(mean(DOVEDISP))
data_promo%>%summarise(mean(DOVEDISP))
data_promo%>% group_by(Chain)%>% dplyr::select(3:10)%>%summarise(mean(FADISP))
data_promo%>% select(3:10)%>%summarise(mean(FADISP))
data_promo%>%summarise(mean(NIVEADISP))
data_promo%>% summarise(mean(FADISP))
data_promo%>% group_by(Chain)%>% dplyr::select(3:10)%>%summarise(mean(SANEXDISP))
data_promo%>% summarise(mean(SANEXDISP))
data_promo%>% group_by(Chain)%>% select(3:10)%>%summarise(mean(VOGUEDISP))
data_promo%>% group_by(Chain)%>% summarise(mean(VOGUEDISP))
data_promo%>% select(3:10)%>%summarise(mean(VOGUEDISP))
data_promo%>% summarise(mean(SANEXDISP))
data_promo%>% group_by(Chain)%>% summarise(mean(VOGUEDISP))
data_promo%>% summarise(mean(VOGUEDISP))
data_promo%>% group_by(Chain)%>% dplyr::select(3:10)%>%summarise(mean(a8X4DISP))
data_promo%>% summarise(mean(a8X4DISP))
data_promo%>% group_by(Chain)%>% select(11:19)%>%summarise(mean(REXONAFEAT))
data_promo%>% group_by(Chain)%>% dplyr::select(11:19)%>%summarise(mean(REXONAFEAT))
data_promo%>% group_by(Chain)%>% dplyr::select(11:19)%>%summarise(mean(REXONAFEAT))
data_promo%>% group_by(Chain)%>% dplyr::select(11:19)%>%summarise(mean(NIVEAFEAT))
data_promo%>% group_by(Chain)%>% dplyr::select(3:10)%>%summarise(mean(a8X4DISP))
data_price%>% group_by(Chain)%>% dplyr::select(3:10)%>%summarise(mean(a8X4RPrice))
data_price%>% group_by(Chain)%>% dplyr::select(3:10)%>%summarise(mean(DOVERPrice))
data_price%>% group_by(Chain)%>% dplyr::select(3:10)%>%summarise(mean(REXONARPrice))
data_promo%>% group_by(Chain)%>% dplyr::select(11:19)%>%summarise(mean(REXONAFEAT))
data_promo%>% summarise(mean(REXONAFEAT))
data_promo%>% group_by(Chain)%>% dplyr::select(11:19)%>%summarise(mean(DOVEFEAT))
data_promo%>%summarise(mean(DOVEFEAT))
data_promo%>% group_by(Chain)%>% dplyr::select(11:19)%>%summarise(mean(FAFEAT))
data_promo%>% summarise(mean(FAFEAT))
data_promo%>% group_by(Chain)%>% dplyr::select(11:19)%>%summarise(mean(NIVEAFEAT))
data_promo%>% summarise(mean(NIVEAFEAT))
data_promo%>% group_by(Chain)%>% dplyr::select(11:19)%>%summarise(mean(SANEXFEAT))
data_promo%>% summarise(mean(SANEXFEAT))
data_promo%>% group_by(Chain)%>% dplyr::select(11:19)%>%summarise(mean(VOGUEFEAT))
data_promo%>% summarise(mean(VOGUEFEAT))
data_promo%>% group_by(Chain)%>%dplyr::select(11:19)%>%summarise(mean(a8X4FEAT))
data_promo%>% summarise(mean(a8X4FEAT))
data_promo%>% group_by(Chain)%>% dplyr::select(11:19)%>%summarise(mean(REXONAFEAT))
data_promo%>% group_by(Chain)%>% dplyr::select(43:50)%>%summarise(mean(REXONAFEAT))
data = read_excel("Data.xls")
###############Promotion
#####DISPLAY
data_promo= cbind(data[1:2],data[27:50])
colnames(data_promo)[8]='a8X4DISP'
colnames(data_promo)[16]='a8X4FEAT'
colnames(data_promo)[24]='a8X4D+F'
data_promo%>% group_by(Chain)%>% dplyr::select(43:50)%>%summarise(mean(REXONAFEAT))
dim(data_promo)
View(data_promo)
colnames(data_promo[20:29])
colnames(data_promo[20:22])
colnames(data_promo[19:22])
data_promo%>% group_by(Chain)%>% dplyr::select(11:19)%>%summarise(mean(REXONAFEAT))
data_promo%>% group_by(Chain)%>%summarise(mean(REXONAFEAT))
colnames(data_promo[19:22])
colnames(data_promo[18:22])
colnames(data_promo[19:22])
colnames(data_promo[19:25])
colnames(data_promo[19:26])
colnames(data_promo[19:27])
colnames(data_promo[19:26])
data_promo%>% group_by(Chain)%>% dplyr::select(43:50)%>%summarise(mean(19))
data_promo%>% group_by(Chain)%>% dplyr::select(19:26)%>%summarise(mean(19))
colnames(data_promo[19:26])
data$WEEK=(seq(1:nrow(data)))
colnames(data)[43]='FADF'
colnames(data)[44]='NIVEADF'
colnames(data)[45]='REXONADF'
colnames(data)[46]='SANEXDF'
colnames(data)[47]='VOGUEDF'
colnames(data)[48]='a8X4DF'
colnames(data)[49]='DOVEDF'
colnames(data)[50]='AXEDF'
colnames(data_promo[19:26])
###############Promotion
#####DISPLAY
data_promo= cbind(data[1:2],data[27:50])
colnames(data_promo[19:26])
data_promo%>% group_by(Chain)%>%summarise(mean(FADF))
data_promo%>% summarise(mean(FADF))
colnames(data_promo[19:26])
data_promo%>% group_by(Chain)%>% select(43:50)%>%summarise(mean(DOVEDF))
data_promo%>% group_by(Chain)%>%summarise(mean(FADF))
data_promo%>% summarise(mean(FADF))
data_promo%>% group_by(Chain)%>%summarise(mean(DOVEDF))
data_promo%>% summarise(mean(DOVEDF))
data_promo%>% group_by(Chain)%>%summarise(mean(FADF))
data_promo%>% summarise(mean(FADF))
data_promo%>% group_by(Chain)%>%summarise(mean(NIVEADF))
data_promo%>% summarise(mean(NIVEADF))
data_promo%>% group_by(Chain)%>%summarise(mean(SANEXDF))
data_promo%>% summarise(mean(SANEXDF))
data_promo%>% group_by(Chain)%>% summarise(mean(VOGUEDF))
data_promo%>% summarise(mean(VOGUEDF))
data_promo%>% group_by(Chain)%>% summarise(mean(a8X4DF))
data_promo%>% summarise(mean(a8X4DF))
data_promo%>% group_by(Chain)%>%summarise(mean(REXONADF))
data_promo%>% summarise(mean(REXONADF))
ggplot(data1, aes(x=WEEK)) +
geom_line(aes(y = REXONAPrice), color = "darkred") +
geom_line(aes(y = DOVEPrice), color="steelblue", linetype="twodash")+
geom_line(aes(y = SANEXPrice), color = "black")+
geom_line(aes(y = NIVEAPrice), color = "#0073C2FF")+
geom_line(aes(y = FAPrice), color = "#EFC000FF")+
geom_line(aes(y = AXEPrice), color = "#868686FF")+
geom_line(aes(y = `8X4Price`), color = "#CD534CFF")+
geom_line(aes(y = VOGUEPrice), color = "#CC79A7")
#######PRICE WAR
ggplot(data1, aes(x=WEEK)) +
geom_line(aes(y = REXONAPrice), color = "darkred") +
geom_line(aes(y = DOVEPrice), color="steelblue", linetype="twodash")+
geom_line(aes(y = SANEXPrice), color = "black")+
# geom_line(aes(y = NIVEAPrice), color = "#0073C2FF")+
# geom_line(aes(y = FAPrice), color = "#EFC000FF")+
# geom_line(aes(y = AXEPrice), color = "#868686FF")+
# geom_line(aes(y = `8X4Price`), color = "#CD534CFF")+
geom_line(aes(y = VOGUEPrice), color = "#CC79A7")
#######PRICE WAR
ggplot(data1, aes(x=WEEK)) +
geom_line(aes(y = REXONAPrice), color = "darkred") +
geom_line(aes(y = DOVEPrice), color="steelblue", linetype="twodash")+
# geom_line(aes(y = SANEXPrice), color = "black")+
# geom_line(aes(y = NIVEAPrice), color = "#0073C2FF")+
# geom_line(aes(y = FAPrice), color = "#EFC000FF")+
# geom_line(aes(y = AXEPrice), color = "#868686FF")+
# geom_line(aes(y = `8X4Price`), color = "#CD534CFF")+
# geom_line(aes(y = VOGUEPrice), color = "#CC79A7")
cormat<- rcorr(as.matrix(data1[,11:20]))  #This shows the main price wars is for DOVE, VOGUE,SANEX
#######PRICE WAR
ggplot(data1, aes(x=WEEK)) +
geom_line(aes(y = REXONAPrice), color = "darkred") +
geom_line(aes(y = DOVEPrice), color="steelblue", linetype="twodash")
#######PRICE WAR
ggplot(data1, aes(x=WEEK)) +
geom_line(aes(y = REXONAPrice), color = "darkred") +
geom_line(aes(y = DOVEPrice), color="steelblue", linetype="twodash")++ theme(legend.position = c(0.8, 0.2))
#######PRICE WAR
ggplot(data1, aes(x=WEEK)) +
geom_line(aes(y = REXONAPrice), color = "darkred") +
geom_line(aes(y = DOVEPrice), color="steelblue", linetype="twodash")+ theme(legend.position = c(0.8, 0.2))
#######PRICE WAR
colors <- c("Rexona" = "darkred", "Dove" = "steelblue")
ggplot(data1, aes(x=WEEK)) +
geom_line(aes(y = REXONAPrice), color = "darkred") +
geom_line(aes(y = DOVEPrice), color="steelblue", linetype="twodash")+
labs(x = "Year",  y = "(%)", color = "Legend") +
scale_color_manual(values = colors)
ggplot(data1, aes(x=WEEK)) +
geom_line(aes(y = REXONAPrice), color = "darkred") +
geom_line(aes(y = DOVEPrice), color="steelblue", linetype="twodash")+
labs(x = "Weeks",  y = "Price", color = "Legend") +
scale_color_manual(values = colors)
colors <- c("Rexona" = "darkred", "Dove" = "steelblue")
ggplot(data1, aes(x=WEEK)) +
geom_line(aes(y = REXONAPrice), color = "darkred") +
geom_line(aes(y = DOVEPrice), color="steelblue", linetype="twodash")+
labs(x = "Weeks",  y = "Price", color = "Legend") +
scale_color_manual(values = colors)
ggplot(data1, aes(x=WEEK)) +
geom_line(aes(y = REXONAPrice), color = "darkred") +
geom_line(aes(y = DOVEPrice), color="steelblue", linetype="twodash")+
labs(x = "Weeks",  y = "Price", color = "Legend") +scale_color_manual(values = colors)
# geom_line(aes(y = NIVEAPrice), color = "#0073C2FF")+
# geom_line(aes(y = FAPrice), color = "#EFC000FF")+
# geom_line(aes(y = AXEPrice), color = "#868686FF")+
# geom_line(aes(y = `8X4Price`), color = "#CD534CFF")+
# geom_line(aes(y = VOGUEPrice), color = "#CC79A7")
library(ggrepel)
ggplot(data1, aes(x=WEEK)) +
geom_line(aes(y = REXONAPrice), color = "darkred") +
geom_line(aes(y = DOVEPrice), color="steelblue", linetype="twodash")+
labs(x = "Weeks",  y = "Price", color = "Legend") +geom_label_repel(aes(label = label),
nudge_x = 1,
na.rm = TRUE)
ggplot(data1, aes(x=WEEK)) +
geom_line(aes(y = REXONAPrice), color = "darkred") +
geom_line(aes(y = DOVEPrice), color="steelblue", linetype="twodash")+
labs(x = "Weeks",  y = "Price", color = "Legend") +scale_color_manual(values = colors)
ggplot(data1, aes(x=WEEK)) +
geom_line(aes(y = REXONAPrice), color = "darkred") +
geom_line(aes(y = DOVEPrice), color="steelblue", linetype="twodash")+
labs(x = "Weeks",  y = "Price", color = "Legend") +scale_color_discrete(guide = FALSE) +
geom_text(aes(label = names(lab), x = 12, colour = names(lab), y = c(lab), hjust = -.02))
ggplot(data1, aes(x=WEEK)) +
geom_line(aes(y = REXONAPrice), color = "darkred") +
geom_line(aes(y = DOVEPrice), color="steelblue", linetype="twodash")+
labs(x = "Weeks",  y = "Price", color = "Legend") +scale_color_discrete(guide = FALSE) +
geom_text(aes(label = names("Rexona"), x = 12, colour = names(lab), y = c(lab), hjust = -.02))
ggplot(data1, aes(x=WEEK)) +
geom_line(aes(y = REXONAPrice), color = "darkred") +
geom_line(aes(y = DOVEPrice), color="steelblue", linetype="twodash")+
labs(x = "Weeks",  y = "Price", color = "Legend") +scale_color_discrete(guide = FALSE) +
geom_text(aes(label = names("Rexona"), x = 12, colour = names(Rexona), y = c(lab), hjust = -.02))
ggplot(data1, aes(x=WEEK)) +
geom_line(aes(y = REXONAPrice), color = "darkred") +
geom_line(aes(y = DOVEPrice), color="steelblue", linetype="twodash")+
labs(x = "Weeks",  y = "Price", color = "Legend") +scale_color_discrete(guide = FALSE) +
geom_text(aes(label = names("Rexona"), x = 12, colour = names(Rexona), y = c(Rexona), hjust = -.02))
ggplot(data1, aes(x=WEEK)) +
geom_line(aes(y = REXONAPrice), color = "darkred") +
geom_line(aes(y = DOVEPrice), color="steelblue", linetype="twodash")+
labs(x = "Weeks",  y = "Price", color = "Legend") +scale_color_discrete(guide = FALSE) +
geom_text(aes(label = names(Rexona), x = 12, colour = names(Rexona), y = c(Rexona), hjust = -.02))
#
ggplot(data1, aes(x=WEEK)) +
geom_line(aes(y = REXONAPrice), color = "darkred") +
geom_line(aes(y = DOVEPrice), color="steelblue", linetype="twodash")+
labs(x = "Weeks",  y = "Price", color = "Legend")
###### ODD NUMBERS
odd_numbers= data_share%>% filter(REXONASales>0.4 |REXONASales<0.1 )
View(odd_numbers)
rexo_mean=mean(data$REXONASales)
rexo_std= sd(data$REXONASales)
odd_numbers= data%>% filter(REXONASales>rexo_mean+(3*(rexo_std)) |REXONASales< rexo_mean-(1*(rexo_std)))
View(odd_numbers)
odd_numbers= data%>% filter(REXONADISP>rexo_mean+(3*(rexo_std)) |REXONADISP< rexo_mean-(1*(rexo_std)))
View(odd_numbers)
rexo_mean=mean(data$REXONADISP)
rexo_std= sd(data$REXONADISP)
odd_numbers= data%>% filter(REXONADISP>rexo_mean+(3*(rexo_std)) |REXONADISP< rexo_mean-(1*(rexo_std)))
View(odd_numbers)
rexo_mean=mean(data$REXONAFEAT)
rexo_std= sd(data$REXONAFEAT)
odd_numbers= data%>% filter(REXONAFEAT>rexo_mean+(3*(rexo_std)) |REXONAFEAT< rexo_mean-(1*(rexo_std)))
View(odd_numbers)
rexo_mean=mean(data$REXONASales)
rexo_std= sd(data$REXONASales)
odd_numbers= data%>% filter(REXONASales>rexo_mean+(3*(rexo_std)) |REXONASales< rexo_mean-(1*(rexo_std)))
View(odd_numbers)
data_price= cbind(data[1:2],data[19:26]-data[11:18])
colnames(data_price)[9]='a8X4RPrice'
data_price%>% group_by(Chain)%>% dplyr::select(3:10)%>%summarise(mean(REXONARPrice))
data_price%>% summarise(mean(REXONARPrice))
data_date= data%>% filter(Chain=='ALBERT HEIJN')%>% dplyr::select(c(1,2))
test = round(data[3:10]/rowSums(data[3:10]),2)
test= test[1:124,]
data_c=data%>% filter(Chain=='ALBERT HEIJN')%>% dplyr::select(11:50)
data1 = cbind(data_date,test,data_c)
cormat<- rcorr(as.matrix(data1[,11:20]))  #This shows the main price wars is for DOVE, VOGUE,SANEX
flattenCorrMatrix <- function(cormat, pmat) {
ut <- upper.tri(cormat)
data.frame(
row = rownames(cormat)[row(cormat)[ut]],
column = rownames(cormat)[col(cormat)[ut]],
cor  =(cormat)[ut],
p = pmat[ut]
)
}
flattenCorrMatrix(cormat$r, cormat$P)
cormat<- rcorr(as.matrix(data_share[,3:10]))  #This shows the main competitors is AXE
flattenCorrMatrix <- function(cormat, pmat) {
ut <- upper.tri(cormat)
data.frame(
row = rownames(cormat)[row(cormat)[ut]],
column = rownames(cormat)[col(cormat)[ut]],
cor  =(cormat)[ut],
p = pmat[ut]
)
}
flattenCorrMatrix(cormat$r, cormat$P)
View(data_share)
market_share_albert = data_share%>% filter(Chain=="ALBERT HEIJN")
View(market_share_albert)
cormat<- rcorr(as.matrix(market_share_albert[,3:10]))  #This shows the main competitors is AXE
flattenCorrMatrix <- function(cormat, pmat) {
ut <- upper.tri(cormat)
data.frame(
row = rownames(cormat)[row(cormat)[ut]],
column = rownames(cormat)[col(cormat)[ut]],
cor  =(cormat)[ut],
p = pmat[ut]
)
}
flattenCorrMatrix(cormat$r, cormat$P)
set.seed(123)
training.samples <- data1_scaled$REXONASales%>%
createDataPartition(p = 0.8, list = FALSE)
train.data  <- data1[training.samples, ]
test.data <- data1[-training.samples, ]
m1 = lm(REXONASales~REXONADISP+REXONAFEAT+REXONADF+REXONAPrice+DOVEPrice+AXEDISP,train.data) #R2=0.77
summary(m1)
cormat<- rcorr(as.matrix(data1[,11:20]))  #This shows the main price wars is for DOVE, VOGUE,SANEX
flattenCorrMatrix <- function(cormat, pmat) {
ut <- upper.tri(cormat)
data.frame(
row = rownames(cormat)[row(cormat)[ut]],
column = rownames(cormat)[col(cormat)[ut]],
cor  =(cormat)[ut],
p = pmat[ut]
)
}
flattenCorrMatrix(cormat$r, cormat$P)
m1 = lm(REXONASales~REXONADISP+REXONAFEAT+REXONADF+REXONAPrice+DOVEPrice+AXEDISP+VOGUEPrice,train.data) #R2=0.77
summary(m1)
m1 = lm(REXONASales~REXONADISP+REXONAFEAT+REXONADF+REXONAPrice+DOVEPrice+AXEDISP+VOGUEPrice+SANEXPrice,train.data) #R2=0.77
summary(m1)
m1 = lm(REXONASales~REXONADISP+REXONAFEAT+REXONADF+REXONAPrice+DOVEPrice+AXEDF,train.data) #R2=0.77
summary(m1)
m1 = lm(REXONASales~REXONADISP+REXONAFEAT+REXONADF+REXONAPrice+DOVEPrice+AXEDISPLAY,train.data) #R2=0.77
m1 = lm(REXONASales~REXONADISP+REXONAFEAT+REXONADF+REXONAPrice+DOVEPrice+AXEDISP,train.data) #R2=0.77
summary(m1)
m1 = lm(REXONASales~REXONADISP+REXONAFEAT+REXONADF+REXONAPrice+DOVEPrice+AXEDISP+AXEDF,train.data) #R2=0.77
summary(m1)
m1 = lm(REXONASales~REXONADISP+REXONAFEAT+REXONADF+REXONAPrice+DOVEPrice+AXEDISP+AXEDF+AXEFEAT,train.data) #R2=0.77
summary(m1)
m1 = lm(REXONASales~REXONADISP+REXONAFEAT+REXONADF+REXONAPrice+DOVEPrice+AXEDF,train.data) #R2=0.77
summary(m1)
m1 = lm(REXONASales~REXONADISP+REXONAFEAT+REXONADF+REXONAPrice+DOVEPrice+AXEDISP,train.data) #R2=0.77
summary(m1)
market_share_albert = data_share%>% filter(Chain=="ALBERT HEIJN")
cormat<- rcorr(as.matrix(market_share_albert[,3:10]))  #This shows the main competitors is AXE
flattenCorrMatrix <- function(cormat, pmat) {
ut <- upper.tri(cormat)
data.frame(
row = rownames(cormat)[row(cormat)[ut]],
column = rownames(cormat)[col(cormat)[ut]],
cor  =(cormat)[ut],
p = pmat[ut]
)
}
flattenCorrMatrix(cormat$r, cormat$P)
m1 = lm(REXONASales~REXONADISP+REXONAFEAT+REXONADF+REXONAPrice+DOVEPrice+AXEDISP+SANEXDF,train.data) #R2=0.77
summary(m1)
m1 = lm(REXONASales~REXONADISP+REXONAFEAT+REXONADF+REXONAPrice+DOVEPrice+AXEDISP+SANEXDISP,train.data) #R2=0.77
summary(m1)
m1 = lm(REXONASales~REXONADISP+REXONAFEAT+REXONADF+REXONAPrice+DOVEPrice+AXEDISP+SANEXFEAT,train.data) #R2=0.77
summary(m1)
m1 = lm(REXONASales~REXONADISP+REXONAFEAT+REXONADF+REXONAPrice+DOVEPrice+AXEDISP+SANEXDISP,train.data) #R2=0.77
summary(m1)
m1 = lm(REXONASales~REXONADISP+REXONAFEAT+REXONADF+REXONAPrice+DOVEPrice+AXEDISP+SANEXDISP+SANEXPrice,train.data) #R2=0.77
summary(m1)
m1 = lm(REXONASales~REXONADISP+REXONAFEAT+REXONADF+REXONAPrice+DOVEPrice+AXEDISP+SANEXDISP+SANEXPrice,train.data) #R2=0.77
m1 = lm(REXONASales~REXONADISP+REXONAFEAT+REXONADF+REXONAPrice+DOVEPrice+AXEDISP,train.data) #R2=0.77
summary(m1)
coefplot(m1, intercept= F,outerCI=1.96, lwdOuter = 1.5,
ylab= "Market share of REXONA",xlab= 'Association with REXONA market share')
